<!--?xml version="1.0" encoding="utf-8"?-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
	<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

	<title>File: GUIDE.txt [spreadsheet-0.6.5.2 Documentation]</title>

	<link type="text/css" media="screen" href="spreadsheet_guide_files/rdoc.css" rel="stylesheet">

	<script src="spreadsheet_guide_files/jquery.js" type="text/javascript" charset="utf-8"></script>
	<script src="spreadsheet_guide_files/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
	<script src="spreadsheet_guide_files/quicksearch.js" type="text/javascript" charset="utf-8"></script>
	<script src="spreadsheet_guide_files/darkfish.js" type="text/javascript" charset="utf-8"></script>
</head>

<body class="file">
	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="http://spreadsheet.rubyforge.org/index.html">Home</a>
          <a href="http://spreadsheet.rubyforge.org/index.html#classes">Classes</a>
          <a href="http://spreadsheet.rubyforge.org/index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="http://spreadsheet.rubyforge.org/GUIDE_txt.html">GUIDE.txt</a></li>
				
					<li class="file"><a href="http://spreadsheet.rubyforge.org/History_txt.html">History.txt</a></li>
				
					<li class="file"><a href="http://spreadsheet.rubyforge.org/LICENSE_txt.html">LICENSE.txt</a></li>
				
					<li class="file"><a href="http://spreadsheet.rubyforge.org/Manifest_txt.html">Manifest.txt</a></li>
				
					<li class="file"><a href="http://spreadsheet.rubyforge.org/README_txt.html">README.txt</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="spreadsheet_guide_files/find.png" alt="[+]" title="show/hide quicksearch" height="16" width="16"></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input name="quicksearch" class="quicksearch-field" type="text">
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Column.html">Spreadsheet::Column</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Compatibility.html">Spreadsheet::Compatibility</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Datatypes.html">Spreadsheet::Datatypes</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Encodings.html">Spreadsheet::Encodings</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel.html">Spreadsheet::Excel</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Error.html">Spreadsheet::Excel::Error</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/ExcelCompatibleWorkbook.html">Spreadsheet::Excel::ExcelCompatibleWorkbook</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Internals.html">Spreadsheet::Excel::Internals</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Internals/Biff5.html">Spreadsheet::Excel::Internals::Biff5</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Internals/Biff8.html">Spreadsheet::Excel::Internals::Biff8</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Offset.html">Spreadsheet::Excel::Offset</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Row.html">Spreadsheet::Excel::Row</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/SstEntry.html">Spreadsheet::Excel::SstEntry</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Workbook.html">Spreadsheet::Excel::Workbook</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Worksheet.html">Spreadsheet::Excel::Worksheet</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Writer.html">Spreadsheet::Excel::Writer</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Writer/Biff8.html">Spreadsheet::Excel::Writer::Biff8</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Writer/Format.html">Spreadsheet::Excel::Writer::Format</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Writer/Workbook.html">Spreadsheet::Excel::Writer::Workbook</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel/Writer/Worksheet.html">Spreadsheet::Excel::Writer::Worksheet</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Font.html">Spreadsheet::Font</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Format.html">Spreadsheet::Format</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Formula.html">Spreadsheet::Formula</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Link.html">Spreadsheet::Link</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/ParseExcel/Worksheet.html">Spreadsheet::ParseExcel::Worksheet</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/ParseExcel/Worksheet/Cell.html">Spreadsheet::ParseExcel::Worksheet::Cell</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Row.html">Spreadsheet::Row</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Workbook.html">Spreadsheet::Workbook</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Worksheet.html">Spreadsheet::Worksheet</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Spreadsheet/Writer.html">Spreadsheet::Writer</a></li>
				
					<li><a href="http://spreadsheet.rubyforge.org/Array.html">Array</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1>Getting Started with <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a></h1>
<p>
This guide is meant to get you started using <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a>. By the end of it, you should be
able to read and write Spreadsheets.
</p>
<h2>Reading is easy!</h2>
<p>
First, make sure all that code is loaded:
</p>
<pre>  require 'spreadsheet'
</pre>
<p>
Worksheets come in various Encodings. You need to tell <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> which Encoding you want to deal
with. The Default is UTF-8
</p>
<pre>  Spreadsheet.client_encoding = 'UTF-8'
</pre>
<p>
Let’s open a workbook:
</p>
<pre>  book = Spreadsheet.open '/path/to/an/excel-file.xls'
</pre>
<p>
We can either access all the Worksheets in a Workbook…
</p>
<pre>  book.worksheets
</pre>
<p>
…or access them by index or name (encoded in your client_encoding)
</p>
<pre>  sheet1 = book.worksheet 0
  sheet2 = Book.worksheet 'Sheet1'
</pre>
<p>
Now you can either iterate over all rows that contain some data. A call to
Worksheet.each without argument will omit empty rows at the beginning of
the Worksheet:
</p>
<pre>  sheet1.each do |row|
    # do something interesting with a row
  end
</pre>
<p>
Or you can tell Worksheet how many rows should be omitted at the beginning.
The following starts at the 3rd row, regardless of whether or not it or the
preceding rows contain any data:
</p>
<pre>  sheet2.each 2 do |row|
    # do something interesting with a row
  end
</pre>
<p>
Or you can access rows directly, by their index (0-based):
</p>
<pre>  row = sheet1.row(3)
</pre>
<p>
To access the values stored in a Row, treat the Row like an <a href="http://spreadsheet.rubyforge.org/Array.html">Array</a>.
</p>
<pre>  row[0]
</pre>
<p>
-&gt; this will return a String, a Float, an Integer, a Formula, a Link or a
Date or DateTime object - or nil if the cell is empty.
</p>
<p>
More information about the formatting of a cell can be found in the Format
with the equivalent index
</p>
<pre>  row.format 2
</pre>
<h2>Writing is easy</h2>
<p>
As before, make sure you have <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a>
required and the client_encoding set. Then make a new Workbook:
</p>
<pre>  book = Spreadsheet::Workbook.new
</pre>
<p>
Add a Worksheet and you’re good to go:
</p>
<pre>  sheet1 = book.create_worksheet
</pre>
<p>
This will create a Worksheet with the Name “Worksheet1”. If you
prefer another name, you may do either of the following:
</p>
<pre>  sheet2 = book.create_worksheet :name =&gt; 'My Second Worksheet'
  sheet1.name = 'My First Worksheet'
</pre>
<p>
Now, add data to the Worksheet, using either Worksheet#[]=,
Worksheet#update_row, or work directly on Row using any of the
Array-Methods that modify an <a href="http://spreadsheet.rubyforge.org/Array.html">Array</a> in place:
</p>
<pre>  sheet1.row(0).concat %w{Name Country Acknowlegement}
  sheet1[1,0] = 'Japan'
  row = sheet1.row(1)
  row.push 'Creator of Ruby'
  row.unshift 'Yukihiro Matsumoto'
  sheet1.row(2).replace [ 'Daniel J. Berger', 'U.S.A.',
                          'Author of original code for Spreadsheet::Excel' ]
  sheet1.row(3).push 'Charles Lowe', 'Author of the ruby-ole Library'
  sheet1.row(3).insert 1, 'Unknown'
  sheet1.update_row 4, 'Hannes Wyss', 'Switzerland', 'Author'
</pre>
<p>
Add some Formatting for flavour:
</p>
<pre>  sheet1.row(0).height = 18

  format = Spreadsheet::Format.new :color =&gt; :blue,
                                   :weight =&gt; :bold,
                                   :size =&gt; 18
  sheet1.row(0).default_format = format

  bold = Spreadsheet::Format.new :weight =&gt; :bold
  4.times do |x| sheet1.row(x + 1).set_format(0, bold) end
</pre>
<p>
And finally, write the Excel File:
</p>
<pre>  book.write '/path/to/output/excel-file.xls'
</pre>
<h2>Modifying an existing Document</h2>
<p>
<a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> has some limited support for
modifying an existing Document. This is done by copying verbatim those
parts of an Excel-document which <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a>
can’t modify (yet), recalculating relevant offsets, and writing the
data that can be changed. Here’s what should work:
</p>
<ul>
<li><p>
Adding, changing and deleting cells.
</p>
</li>
<li><p>
You should be able to fill in Data to be evaluated by predefined Formulas
</p>
</li>
</ul>
<p>
Limitations:
</p>
<ul>
<li><p>
<a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> can only write BIFF8 (Excel97
and higher). The results of modifying an earlier version of Excel are
undefined.
</p>
</li>
<li><p>
<a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> does not modify Formatting at
present. That means in particular that if you set the Value of a Cell to a
Date, it can only be read as a Date if its Format was set correctly prior
to the change.
</p>
</li>
<li><p>
Although it is theoretically possible, it is not recommended to write the
resulting Document back to the same File/IO that it was read from.
</p>
</li>
</ul>
<p>
And here’s how it works:
</p>
<pre>  book = Spreadsheet.open '/path/to/an/excel-file.xls'
  sheet = book.worksheet 0
  sheet.each do |row|
    row[0] *= 2
  end
  book.write '/path/to/output/excel-file.xls'
</pre>
<h2>Date and DateTime</h2>
<p>
Excel does not know a separate Datatype for Dates. Instead it encodes Dates
into standard floating-point numbers and recognizes a Date-Cell by its
formatting-string:
</p>
<pre>  row.format(3).number_format
</pre>
<p>
Whenever a Cell’s Format describes a Date or Time, <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> will give you the decoded Date or
DateTime value. Should you need to access the underlying Float, you may do
the following:
</p>
<pre>  row.at(3)
</pre>
<p>
If for some reason the Date-recognition fails, you may force Date-decoding:
</p>
<pre>  row.date(3)
  row.datetime(3)
</pre>
<p>
When you set the value of a Cell to a Date, Time or DateTime, <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> will try to set the cell’s
number-format to a corresponding value (one of Excel’s builtin
formats). If you have already defined a Date- or DateTime-format, <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> will use that instead. If a format
has already been applied to a particular Cell, <a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> will leave it untouched:
</p>
<pre>  row[4] = Date.new 1975, 8, 21
  # -&gt; assigns the builtin Date-Format: 'M/D/YY'
  book.add_format Format.new(:number_format =&gt; 'DD.MM.YYYY hh:mm:ss')
  row[5] = DateTime.new 2008, 10, 12, 11, 59
  # -&gt; assigns the added DateTime-Format: 'DD.MM.YYYY hh:mm:ss'
  row.set_format 6, Format.new(:number_format =&gt; 'D-MMM-YYYY')
  row[6] = Time.new 2008, 10, 12
  # -&gt; the Format of cell 6 is left unchanged.
</pre>
<h2>Outline (Grouping) and Hiding</h2>
<p>
<a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> supports outline (grouping) and
hiding functions from version  0.6.5. In order to hide rows or columns, you
can use ‘hidden’ property.  As for outline,
‘outline_level’ property is also available. You can use  both
‘hidden’ and ‘outline_level’ at the same time.
</p>
<p>
You can create a new file with outline and hiding rows and columns as
follows:
</p>
<pre>  require 'spreadsheet'
  
  # create a new book and sheet
  book = Spreadsheet::Workbook.new
  sheet = book.create_worksheet
  5.times {|j| 5.times {|i| sheet[j,i] = (i+1)*10**j}}
  
  # column
  sheet.column(2).hidden = true
  sheet.column(3).hidden = true
  sheet.column(2).outline_level = 1
  sheet.column(3).outline_level = 1
  
  # row
  sheet.row(2).hidden = true
  sheet.row(3).hidden = true
  sheet.row(2).outline_level = 1
  sheet.row(3).outline_level = 1
  
  # save file
  book.write 'out.xls'
</pre>
<p>
Also you can read an existing file and change the hidden and outline
properties. Here is the example below:
</p>
<pre>  require 'spreadsheet'
  
  # read an existing file
  file = ARGV[0]
  book = Spreadsheet.open(file, 'rb')
  sheet= book.worksheet(0)
  
  # column
  sheet.column(2).hidden = true
  sheet.column(3).hidden = true
  sheet.column(2).outline_level = 1
  sheet.column(3).outline_level = 1
  
  # row
  sheet.row(2).hidden = true
  sheet.row(3).hidden = true
  sheet.row(2).outline_level = 1
  sheet.row(3).outline_level = 1
  
  # save file
  book.write "out.xls"
</pre>
<p>
Notes
</p>
<pre>  * The outline_level should be under 8, which is due to the Excel data format.
</pre>
<h2>More about Encodings</h2>
<p>
<a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> assumes it’s running on
Ruby 1.8 with Iconv-support. It is your responsibility to handle Conversion
Errors, or to prevent them e.g. by using the Iconv Transliteration and
Ignore flags: Spreadsheet.client_encoding =
‘LATIN1//TRANSLIT//IGNORE‘
</p>
<h2>Backward Compatibility</h2>
<p>
<a href="http://spreadsheet.rubyforge.org/Spreadsheet.html">Spreadsheet</a> is designed to be a drop-in
replacement for both ParseExcel and <a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel.html">Spreadsheet::Excel</a>. It provides a number
of require-paths for backward compatibility with its predecessors. If you
have been working with ParseExcel, you have probably used one or more of
the following:
</p>
<pre>  require 'parseexcel'
  require 'parseexcel/parseexcel'
  require 'parseexcel/parser'
</pre>
<p>
Either of the above will define the ParseExcel.parse method as a facade to
Spreadsheet.open. Additionally, this will alter Spreadsheets behavior to
define the ParseExcel::Worksheet::Cell class and fill each parsed Row with
instances thereof, which in turn provide ParseExcel’s
Cell#to_s(encoding) and Cell#date methods. You will have to manually
uninstall the parseexcel library.
</p>
<p>
If you are upgrading from <a href="http://spreadsheet.rubyforge.org/Spreadsheet/Excel.html">Spreadsheet::Excel</a>, you were probably
using Workbook#add_worksheet and Worksheet#write, write_row or
write_column. Use the following to load the code which provides them:
</p>
<pre>  require 'spreadsheet/excel'
</pre>
<p>
Again, you will have to manually uninstall the spreadsheet-excel library.
</p>
<p>
If you perform fancy formatting, you may run into trouble as the Format
implementation has changed considerably. If that is the case, please drop
me a line at hannes.wyss@gmail.com and I will try to help you. Don’t
forget to include the offending code-snippet!
</p>
<p>
All compatibility code is deprecated and will be removed in version 1.0.0
</p>

	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>



</body></html>